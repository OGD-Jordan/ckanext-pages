{% import 'macros/form.html' as form %}

{% if errors %}
  <div class="alert alert-danger">
    <strong>{{ _('Error(s)') }}:</strong>
    <ul>
      {% for field, error in errors.items() %}
        <li>{{ error }}</li>
      {% endfor %}
    </ul>
  </div>
{% endif %}

<form method="post" action="{{ h.url_for('header_management.update_main_menu') }}">
  {{ h.csrf_input() }}

  <!-- Title (English) -->
  {{ form.input('title_en',
      label=_('Title (English)'),
      id='field-title-en',
      value=data.title_en,
      error=errors.title_en,
      classes=['control-medium'],
      is_required=true
  ) }}

  <!-- Title (Arabic) -->
  {{ form.input('title_ar',
      label=_('Title (Arabic)'),
      id='field-title-ar',
      value=data.title_ar,
      error=errors.title_ar,
      classes=['control-medium'],
      is_required=true
  ) }}

  <!-- Link (English) -->
  {{ form.input('link_en',
      label=_('Link (English)'),
      id='field-link-en',
      value=data.link_en,
      error=errors.link_en,
      classes=['control-medium'],
      is_required=true
  ) }}

  <!-- Link (Arabic) -->
  {{ form.input('link_ar',
      label=_('Link (Arabic)'),
      id='field-link-ar',
      value=data.link_ar,
      error=errors.link_ar,
      classes=['control-medium'],
      is_required=true
  ) }}

  <!-- Menu Type -->
  {{ form.select('menu_type',
      label=_('Type'),
      options=[
          {'value': 'link', 'text': _('Link')},
          {'value': 'menu', 'text': _('Menu')}
      ],
      selected=data.menu_type,
      error=errors.menu_type
  ) }}

  <!-- Parent Menu -->
  {{ form.select('parent_id',
      label=_('Parent'),
      options=parent_options,
      selected=data.parent_id,
      error=errors.parent_id
  ) }}

  <!-- Order -->
  {{ form.input('order',
      label=_('Order'),
      id='field-order',
      value=data.order,
      error=errors.order,
      classes=['control-medium'],
      type='number'
  ) }}

  <!-- Visibility Toggle -->
  <div class="control-group">
    <label class="control-label" for="is_visible">{{ _('Visible') }}</label>
    <div class="controls">
      <input type="checkbox" id="is_visible" name="is_visible" {% if data.is_visible %}checked{% endif %}>
    </div>
  </div>

  <div class="form-actions">
    {% if not data.id %}
      {{ form.button(_('Add Menu Item'), type='submit', class_='btn btn-primary') }}
    {% else %}
      {{ form.button(_('Save'), type='submit', class_='btn btn-primary') }}
      <a href="{{ h.url_for('header_management.delete_main_menu', id=data.id) }}" class="btn btn-danger" onclick="return confirm('Are you sure you want to delete this menu item?');">{{ _('Delete') }}</a>
      <a href="{{ h.url_for('header_management.toggle_main_menu_visibility', id=data.id) }}" class="btn btn-warning">{{ _('Toggle Visibility') }}</a>
    {% endif %}
  </div>
</form>